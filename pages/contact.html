<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·∫∑t B√†n | Caf√© Focus</title>
    <link rel="stylesheet" href="../assets/fonts/fonts.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="../images/logo1.jpg">
</head>
<body>
    <!-- Navigation -->
       <nav class="navbar">
            <div class="container">
                <a href="../index.html" class="logo">
                    <img src="../images//logo1.jpg" alt="Caf√© Focus Logo" height="40">
                    <span>Caf√© Focus</span>
                </a>
                
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                
                <ul class="nav-menu" id="navMenu">
                    <li><a href="../index.html" >TRANG CH·ª¶</a></li>
                    <li><a href="about.html" >V·ªÄ CH√öNG T√îI</a></li>
                    <li><a href="services.html">KH√îNG GIAN & D·ªäCH V·ª§</a></li>
                    <li><a href="menu.html">MENU</a></li>  
                    <li><a href="contact.html" class="active">ƒê·∫∂T B√ÄN</a></li>  
                    <li><a href="reviews.html">ƒê√ÅNH GI√Å <i class="fas fa-star"></i></a></li>
                </ul>
                
                <!-- User Menu - ƒê√É DI CHUY·ªÇN V√ÄO TRONG CONTAINER -->
                <div class="user-menu" id="userMenu">
                    <button class="user-btn" id="userBtn">
                        <span id="userName">T√†i kho·∫£n</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="user-dropdown" id="userDropdown">
                        <div class="user-info">
                            <div class="user-avatar" id="userAvatar">ND</div>
                            <div>
                                <strong id="dropdownUserName">Ng∆∞·ªùi d√πng</strong>
                                <small id="userEmail">user@example.com</small>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="orders.html" class="dropdown-item">
                            <i class="fas fa-shopping-bag"></i> ƒê∆°n h√†ng
                        </a>
                        <button class="dropdown-item logout-btn" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
                        </button>
                    </div>
                </div>
            </div>
        </nav>

    <!-- Hero Section -->
    <section class="contact-hero">
        <div class="contact-container">
            <h1 class="contact-title">ƒê·∫∂T B√ÄN</h1>
            <p class="contact-subtitle">
                K·∫øt n·ªëi v·ªõi ch√∫ng t√¥i ƒë·ªÉ tr·∫£i nghi·ªám kh√¥ng gian l√†m vi·ªác v√† h·ªçc t·∫≠p t·ªëi ∆∞u
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <section class="section">
        <div class="contact-container">
            <!-- Booking Form Section -->
            <div class="booking-section-wrapper">
                
                
                <!-- Booking form m·ªõi theo b·ªë c·ª•c ·∫£nh -->
                <div class="booking-form-ui">
                    <!-- Tab Navigation -->
                    <div style="display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid #f0f0f0; justify-content: center;">
                        <button class="booking-tab-btn active" onclick="switchTab('booking-form')" style="padding: 12px 24px; background: none; border: none; font-size: 1rem; font-weight: 600; color: #2a6bff; border-bottom: 3px solid #2a6bff; cursor: pointer; transition: all 0.3s ease; text-align: center;">
                            <i class="fas fa-clipboard-list"></i> ƒê·∫∂T B√ÄN M·ªöI
                        </button>
                        <button class="booking-tab-btn" onclick="switchTab('booking-history')" style="padding: 12px 24px; background: none; border: none; font-size: 1rem; font-weight: 600; color: #999; border-bottom: 3px solid transparent; cursor: pointer; transition: all 0.3s ease; text-align: center;">
                            <i class="fas fa-history"></i> L·ªäCH S·ª¨ ƒê·∫∂T B√ÄN <span id="history-count" style="background: #ff6b6b; color: white; padding: 2px 8px; border-radius: 12px; margin-left: 5px; font-size: 0.9rem;">0</span>
                        </button>
                    </div>
                    
                    <div class="booking-header">
                    <h2>ƒê·∫∂T B√ÄN TR·ª∞C TUY·∫æN</h2>
                    <p>Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin v√†o form b√™n d∆∞·ªõi</p>
                </div>
                    
                    <form id="bookingForm">
                        <!-- Th·ªùi gian ƒë·∫∑t b√†n -->
                        <div class="form-section">
                            <h3 class="form-section-title"><i class="far fa-calendar-alt"></i> TH·ªúI GIAN ƒê·∫∂T B√ÄN</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="booking-date">Ng√†y ƒë·∫∑t <span class="required">*</span></label>
                                    <input type="text" id="booking-date-display" placeholder="DD/MM/YYYY" required readonly style="cursor: pointer;">
                                    <input type="date" id="booking-date" name="booking-date" required style="display: none;">
                                </div>
                                
                                <div class="form-group">
                                    <label for="booking-time">Gi·ªù ƒë·∫∑t <span class="required">*</span></label>
                                    <input type="time" id="booking-time" name="booking-time" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="duration">Th·ªùi l∆∞·ª£ng <span class="required">*</span></label>
                                    <select id="duration" name="duration" required>
                                        <option value="">Ch·ªçn th·ªùi l∆∞·ª£ng</option>
                                        <option value="1">1 gi·ªù</option>
                                        <option value="2">2 gi·ªù</option>
                                        <option value="3">3 gi·ªù</option>
                                        <option value="4">4 gi·ªù</option>
                                        <option value="5">5 gi·ªù</option>
                                        <option value="6">6 gi·ªù tr·ªü l√™n</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="number-of-people">S·ªë ng∆∞·ªùi <span class="required">*</span></label>
                                    <select id="number-of-people" name="number-of-people" required>
                                        <option value="">Ch·ªçn s·ªë ng∆∞·ªùi</option>
                                        <option value="1">1 ng∆∞·ªùi</option>
                                        <option value="2">2 ng∆∞·ªùi</option>
                                        <option value="3">3 ng∆∞·ªùi</option>
                                        <option value="4">4 ng∆∞·ªùi</option>
                                        <option value="5">5-6 ng∆∞·ªùi</option>
                                        <option value="7">7-8 ng∆∞·ªùi</option>
                                        <option value="9">Tr√™n 8 ng∆∞·ªùi</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ch·ªçn khu v·ª±c / lo·∫°i b√†n -->
                        <div class="form-section">
                            <h3 class="form-section-title"><i class="fas fa-chair"></i> CH·ªåN KHU V·ª∞C / LO·∫†I B√ÄN</h3>
                            <div class="table-type-grid">
                                
                                <div class="table-type-option" data-type="single">
                                    <i class="fas fa-user"></i>
                                    <span>B√†n ƒë∆°n</span>
                                    <small>1 - 2 ng∆∞·ªùi</small>
                                </div>

                                <div class="table-type-option" data-type="group">
                                    <i class="fas fa-users"></i>
                                    <span>B√†n nh√≥m</span>
                                    <small>4 - 6 ng∆∞·ªùi</small>
                                </div>

                                <div class="table-type-option" data-type="group">
                                    <i class="fas fa-users"></i>
                                    <span>B√†n nh√≥m</span>
                                    <small>Tr√™n 8 ng∆∞·ªùi</small>
                                </div>
                                                                                              
                                <div class="table-type-option" data-type="vip">
                                    <i class="fas fa-crown"></i>
                                    <span>Ph√≤ng VIP</span>
                                    <small>Ri√™ng t∆∞, ƒë·∫ßy ƒë·ªß ti·ªán nghi</small>
                                </div>
                                
                                <div class="table-type-option" data-type="outdoor">
                                    <i class="fas fa-leaf"></i>
                                    <span>Khu ngo√†i tr·ªùi</span>
                                    <small>Tho√°ng m√°t</small>
                                </div>
                            </div>
                            <input type="hidden" id="table-type" name="table-type" required>
                            <!-- Ch·ªçn s·ªë b√†n (s·∫Ω ƒë∆∞·ª£c populate b·ªüi JS) -->
                            <div class="form-group" style="margin-top:12px;">
                                <label for="table-number">CH·ªåN B√ÄN <span class="required">*</span></label>
                                <select id="table-number" name="table-number" required>
                                    <option value="">Ch·ªçn b√†n (t·ª± ƒë·ªông hi·ªÉn th·ªã theo lo·∫°i)</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Th√¥ng tin ng∆∞·ªùi ƒë·∫∑t -->
                        <div class="form-section">
                            <h3 class="form-section-title"><i class="fas fa-user-circle"></i> TH√îNG TIN NG∆Ø·ªúI ƒê·∫∂T</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="customer-name">H·ªç v√† t√™n <span class="required">*</span></label>
                                    <input type="text" id="customer-name" name="customer-name" required placeholder="Nh·∫≠p h·ªç v√† t√™n">
                                </div>
                                
                                <div class="form-group">
                                    <label for="customer-phone">S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
                                    <input type="tel" id="customer-phone" name="customer-phone" required placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
                                </div>
                                
                                <div class="form-group">
                                    <label for="customer-email">Email <span class="required">*</span></label>
                                    <input type="email" id="customer-email" name="customer-email" required placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ email">
                                </div>

                            </div>
                        </div>
                        
                        <!-- Ghi ch√∫ -->
                        <div class="form-section">
                            <h3 class="form-section-title"><i class="fas fa-sticky-note"></i> GHI CH√ö TH√äM</h3>
                            <div class="form-group">
                                <label for="additional-notes">Ghi ch√∫ cho qu√°n</label>
                                <textarea id="additional-notes" name="additional-notes" rows="3" placeholder="Vui l√≤ng ghi ch√∫ th√™m n·∫øu c√≥ y√™u c·∫ßu ƒë·∫∑c bi·ªát..."></textarea>
                            </div>
                        </div>
                        
                        <!-- Ch√≠nh s√°ch - L∆∞u √Ω -->
                        <div class="notes-box">
                            <h4><i class="fas fa-info-circle"></i> CH√çNH S√ÅCH & L∆ØU √ù</h4>
                            <ul>
                                <li>Vui l√≤ng ƒë·∫øn ƒë√∫ng gi·ªù ƒë√£ ƒë·∫∑t. B√†n s·∫Ω ƒë∆∞·ª£c gi·ªØ trong 15 ph√∫t</li>
                                <li>H·ªßy ƒë·∫∑t b√†n tr∆∞·ªõc √≠t nh·∫•t 2 gi·ªù ƒë·ªÉ kh√¥ng b·ªã t√≠nh ph√≠</li>
                                <li>ƒê·∫∑t c·ªçc 50k khi ƒë·∫∑t b√†n nh√≥m t·ª´ 4 ng∆∞·ªùi tr·ªü l√™n</li>
                                <li>Kh√¥ng mang th·ª©c ƒÉn n∆∞·ªõc u·ªëng b√™n ngo√†i v√†o qu√°n</li>
                                <li>Gi·ªØ tr·∫≠t t·ª± chung ƒë·ªÉ kh√¥ng l√†m ·∫£nh h∆∞·ªüng ƒë·∫øn kh√°ch kh√°c</li>
                            </ul>
                        </div>
                        
                        <!-- N√∫t ƒë·∫∑t b√†n -->
                        <button type="submit" class="btn-booking">
                            <i class="fas fa-check-circle"></i> ƒê·∫∂T B√ÄN NGAY
                        </button>
                    </form>
                    
                    <!-- Th√¥ng b√°o th√†nh c√¥ng -->
                    <div id="bookingSuccess" style="display: none; text-align: center; padding: 30px;">
                        <i class="fas fa-check-circle" style="font-size: 50px; color: #2ecc71; margin-bottom: 20px;"></i>
                        <h3 style="color: #2c3e50; margin-bottom: 15px;">ƒê·∫∂T B√ÄN TH√ÄNH C√îNG!</h3>
                        <p style="color: #555; margin-bottom: 25px;">C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t b√†n t·∫°i Caf√© Focus. Ch√∫ng t√¥i s·∫Ω x√°c nh·∫≠n qua ƒëi·ªán tho·∫°i trong v√≤ng 30 ph√∫t.</p>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            <button onclick="resetBookingForm()" class="btn-booking" style="max-width: 300px;">
                                <i class="fas fa-redo"></i> ƒê·∫∂T B√ÄN M·ªöI
                            </button>
                            <button onclick="switchTab('booking-history')" class="btn-booking" style="max-width: 300px; background: #00c9a7;">
                                <i class="fas fa-history"></i> XEM L·ªäCH S·ª¨
                            </button>
                        </div>
                    </div>
                    
                    <!-- L·ªãch s·ª≠ ƒë·∫∑t b√†n -->
                    <div id="booking-history-tab" style="display: none;">
                        <h3 style="color: #2c3e50; margin-bottom: 12px; font-size: 1.5rem;"><i class="fas fa-history"></i> L·ªäCH S·ª¨ ƒê·∫∂T B√ÄN</h3>

                        <!-- Filters for booking history -->
                        <div class="booking-filters" style="display:flex;gap:10px;align-items:center;margin:8px 0 18px;flex-wrap:wrap;">
                            <select id="booking-filter-status" style="padding:8px;border-radius:8px;border:1px solid #ddd;">
                                <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                <option value="pending">Ch·ªù x√°c nh·∫≠n</option>
                                <option value="confirmed">ƒê√£ x√°c nh·∫≠n</option>
                                <option value="checked-in">Checked-in / ƒêang s·ª≠ d·ª•ng</option>
                                <option value="completed">Ho√†n t·∫•t</option>
                                <option value="no-show">Kh√¥ng ƒë·∫øn</option>
                                <option value="unavailable">H·∫øt b√†n</option>
                            </select>

                            <input id="booking-filter-time" type="time" title="L·ªçc theo gi·ªù check-in" style="padding:8px;border-radius:8px;border:1px solid #ddd;" />

                            <select id="booking-filter-table" style="padding:8px;border-radius:8px;border:1px solid #ddd;min-width:140px;">
                                <option value="">T·∫•t c·∫£ b√†n</option>
                            </select>

                            <input id="booking-filter-search" placeholder="T√¨m ki·∫øm t√™n, ƒëi·ªán tho·∫°i, email..." style="flex:1;min-width:180px;padding:8px;border-radius:8px;border:1px solid #ddd;" />

                            <button id="booking-filter-clear" style="padding:8px 12px;border-radius:8px;border:none;background:#95a5a6;color:white;cursor:pointer;">X√≥a</button>
                        </div>

                        <div id="booking-history-list" style="display: grid; gap: 15px;">
                            <p style="text-align: center; color: #999; padding: 30px;">Ch∆∞a c√≥ l·ªãch s·ª≠ ƒë·∫∑t b√†n</p>
                        </div>
                    </div>
                </div>
            </div>
            
<!-- Ph·∫ßn li√™n h·ªá v√† th√¥ng tin -->
<div class="contact-grid">
    <!-- Contact Information -->
    <div class="contact-info-card" style="padding: 3rem; border-radius: 24px; box-shadow: 0 10px 40px rgba(42, 107, 255, 0.15); background: linear-gradient(135deg, #ffffff, #f8faff); border: 2px solid rgba(42, 107, 255, 0.1); position: relative; overflow: hidden;">
        
        <!-- Background decorative elements -->
        <div style="position: absolute; top: -100px; right: -100px; width: 300px; height: 300px; background: radial-gradient(circle, rgba(42, 107, 255, 0.08) 0%, transparent 70%); border-radius: 50%; z-index: 1;"></div>
        <div style="position: absolute; bottom: -80px; left: -80px; width: 200px; height: 200px; background: radial-gradient(circle, rgba(0, 201, 167, 0.08) 0%, transparent 70%); border-radius: 50%; z-index: 1;"></div>
        
        <div style="position: relative; z-index: 2;">
            <h2 class="info-title" style="text-align: center; margin-bottom: 3rem; font-size: 2.8rem; font-weight: 800; color: #2c3e50; position: relative; padding-bottom: 1.2rem;">
                TH√îNG TIN LI√äN H·ªÜ
                <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 80px; height: 5px; background: linear-gradient(90deg, #2a6bff, #00c9a7); border-radius: 3px;"></div>
            </h2>
            
            <!-- H√†ng 1: ƒê·ªãa ch·ªâ v√† ƒêi·ªán tho·∫°i -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 2.5rem; margin-bottom: 2.5rem;">
                
                <!-- ƒê·ªãa ch·ªâ -->
                <div class="contact-info-item" style="padding: 2.2rem; border-radius: 16px; display: flex; align-items: flex-start; gap: 1.5rem; background: white; box-shadow: 0 6px 20px rgba(42, 107, 255, 0.08); border: 2px solid rgba(42, 107, 255, 0.05); transition: all 0.3s ease; min-height: 180px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, #2a6bff, #00c9a7);"></div>
                    <div class="info-icon" style="width: 65px; height: 65px; min-width: 65px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: linear-gradient(135deg, #2a6bff, #00c9a7); border-radius: 14px; box-shadow: 0 6px 15px rgba(42, 107, 255, 0.25);">
                        <i class="fas fa-map-marker-alt" style="font-size: 1.8rem; color: white;"></i>
                    </div>
                    <div class="info-content" style="flex: 1;">
                        <h3 style="font-size: 1.3rem; margin-bottom: 0.8rem; font-weight: 700; color: #2c3e50; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üìç</span> ƒê·ªäA CH·ªà
                        </h3>
                        <p style="font-size: 1.05rem; line-height: 1.7; color: #555; margin: 0; font-weight: 500;">
                            123A, ƒê∆∞·ªùng Nguy·ªÖn VƒÉn C·ª´ N·ªëi D√†i<br>
                            Ph∆∞·ªùng Ninh Ki·ªÅu, C·∫ßn Th∆°
                        </p>
                    </div>
                </div>
                
                <!-- ƒêi·ªán tho·∫°i -->
                <div class="contact-info-item" style="padding: 2.2rem; border-radius: 16px; display: flex; align-items: flex-start; gap: 1.5rem; background: white; box-shadow: 0 6px 20px rgba(42, 107, 255, 0.08); border: 2px solid rgba(42, 107, 255, 0.05); transition: all 0.3s ease; min-height: 180px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, #00c9a7, #2a6bff);"></div>
                    <div class="info-icon" style="width: 65px; height: 65px; min-width: 65px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: linear-gradient(135deg, #00c9a7, #2a6bff); border-radius: 14px; box-shadow: 0 6px 15px rgba(0, 201, 167, 0.25);">
                        <i class="fas fa-phone" style="font-size: 1.8rem; color: white;"></i>
                    </div>
                    <div class="info-content" style="flex: 1;">
                        <h3 style="font-size: 1.3rem; margin-bottom: 0.8rem; font-weight: 700; color: #2c3e50; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üìû</span> ƒêI·ªÜN THO·∫†I
                        </h3>
                        <p style="font-size: 1.05rem; line-height: 1.9; color: #555; margin: 0;">
                            <strong style="color: #2c3e50; font-weight: 600;">Hotline:</strong> 
                            <a href="tel:0909123456" class="phone-link" style="color: #2a6bff; text-decoration: none; font-weight: 700; padding: 2px 6px; border-radius: 4px; transition: all 0.2s ease;">0909 123 456</a>
                            <br>
                            <strong style="color: #2c3e50; font-weight: 600;">H·ªó tr·ª£:</strong> 
                            <a href="tel:0900666888" class="phone-link" style="color: #2a6bff; text-decoration: none; font-weight: 700; padding: 2px 6px; border-radius: 4px; transition: all 0.2s ease;">0900 666 888</a>
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- H√†ng 2: Email v√† Gi·ªù m·ªü c·ª≠a -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 2.5rem;">
                
                <!-- Email -->
                <div class="contact-info-item" style="padding: 2.2rem; border-radius: 16px; display: flex; align-items: flex-start; gap: 1.5rem; background: white; box-shadow: 0 6px 20px rgba(42, 107, 255, 0.08); border: 2px solid rgba(42, 107, 255, 0.05); transition: all 0.3s ease; min-height: 180px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, #ff6b6b, #ffa502);"></div>
                    <div class="info-icon" style="width: 65px; height: 65px; min-width: 65px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: linear-gradient(135deg, #ff6b6b, #ffa502); border-radius: 14px; box-shadow: 0 6px 15px rgba(255, 107, 107, 0.25);">
                        <i class="fas fa-envelope" style="font-size: 1.8rem; color: white;"></i>
                    </div>
                    <div class="info-content" style="flex: 1;">
                        <h3 style="font-size: 1.3rem; margin-bottom: 0.8rem; font-weight: 700; color: #2c3e50; display: flex; align-items: center; gap: 0.5rem;">
                            <span>‚úâÔ∏è</span> EMAIL
                        </h3>
                        <p style="font-size: 1.05rem; line-height: 1.8; color: #555; margin: 0;">
                            <a href="mailto:cafefocus@gmail.com" style="color: #2c3e50; text-decoration: none; font-weight: 600; padding: 2px 6px; border-radius: 4px; transition: all 0.2s ease;">cafefocus@gmail.com</a>
                            <br>
                            <a href="mailto:partnership@cafefocus.com" style="color: #2c3e50; text-decoration: none; font-weight: 600; padding: 2px 6px; border-radius: 4px; transition: all 0.2s ease;">partnership@cafefocus.com</a>
                        </p>
                    </div>
                </div>
                
                <!-- Gi·ªù m·ªü c·ª≠a -->
                <div class="contact-info-item" style="padding: 2.2rem; border-radius: 16px; display: flex; align-items: flex-start; gap: 1.5rem; background: white; box-shadow: 0 6px 20px rgba(42, 107, 255, 0.08); border: 2px solid rgba(42, 107, 255, 0.05); transition: all 0.3s ease; min-height: 180px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, #5f27cd, #341f97);"></div>
                    <div class="info-icon" style="width: 65px; height: 65px; min-width: 65px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: linear-gradient(135deg, #5f27cd, #341f97); border-radius: 14px; box-shadow: 0 6px 15px rgba(95, 39, 205, 0.25);">
                        <i class="fas fa-clock" style="font-size: 1.8rem; color: white;"></i>
                    </div>
                    <div class="info-content" style="flex: 1;">
                        <h3 style="font-size: 1.3rem; margin-bottom: 0.8rem; font-weight: 700; color: #2c3e50; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üïê</span> GI·ªú M·ªû C·ª¨A
                        </h3>
                        <div class="business-hours" style="font-size: 1.05rem; line-height: 1.9; color: #555;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 4px 0;">
                                <span style="font-weight: 600;">Th·ª© 2 - Th·ª© 7:</span>
                                <span style="color: #2a6bff; font-weight: 700;">7:00 - 00:00</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 4px 0;">
                                <span style="font-weight: 600;">Ch·ªß nh·∫≠t:</span>
                                <span style="color: #ff6b6b; font-weight: 700;">7:00 - 22:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- K·∫øt n·ªëi v·ªõi ch√∫ng t√¥i -->
            <div class="social-section" style="margin-top: 3.5rem; padding-top: 2.5rem; border-top: 2px solid rgba(42, 107, 255, 0.15); text-align: center;">
                <h3 style="font-size: 1.5rem; color: #2c3e50; margin-bottom: 1.8rem; font-weight: 700; position: relative; display: inline-block; padding-bottom: 0.8rem;">
                    K·∫æT N·ªêI V·ªöI CH√öNG T√îI
                    <div style="position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: linear-gradient(90deg, #2a6bff, #00c9a7, #ff6b6b, #5f27cd); border-radius: 2px;"></div>
                </h3>
                <div class="social-icons" style="display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap;">
                    <a href="#" class="social-icon facebook" style="width: 58px; height: 58px; border-radius: 14px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #1877F2, #0A5BC4); color: white; font-size: 1.6rem; transition: all 0.3s ease; box-shadow: 0 6px 15px rgba(24, 119, 242, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); transition: 0.5s;"></div>
                        <i class="fab fa-facebook-f" style="position: relative; z-index: 2;"></i>
                    </a>
                    <a href="#" class="social-icon twitter" style="width: 58px; height: 58px; border-radius: 14px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #1DA1F2, #0C85D0); color: white; font-size: 1.6rem; transition: all 0.3s ease; box-shadow: 0 6px 15px rgba(29, 161, 242, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); transition: 0.5s;"></div>
                        <i class="fab fa-twitter" style="position: relative; z-index: 2;"></i>
                    </a>
                    <a href="#" class="social-icon instagram" style="width: 58px; height: 58px; border-radius: 14px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D); color: white; font-size: 1.6rem; transition: all 0.3s ease; box-shadow: 0 6px 15px rgba(193, 53, 132, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); transition: 0.5s;"></div>
                        <i class="fab fa-instagram" style="position: relative; z-index: 2;"></i>
                    </a>
                    <a href="#" class="social-icon tiktok" style="width: 58px; height: 58px; border-radius: 14px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #000000, #25F4EE, #FE2C55); color: white; font-size: 1.6rem; transition: all 0.3s ease; box-shadow: 0 6px 15px rgba(254, 44, 85, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); transition: 0.5s;"></div>
                        <i class="fab fa-tiktok" style="position: relative; z-index: 2;"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Th√™m style cho hover effects */
    .contact-info-item {
        transition: all 0.3s ease !important;
    }
    
    .contact-info-item:hover {
        transform: translateY(-8px) !important;
        box-shadow: 0 12px 30px rgba(42, 107, 255, 0.15) !important;
        border-color: rgba(42, 107, 255, 0.2) !important;
    }
    
    .info-icon {
        transition: all 0.3s ease !important;
    }
    
    .contact-info-item:hover .info-icon {
        transform: rotate(15deg) scale(1.1) !important;
    }
    
    .phone-link:hover {
        background-color: #2a6bff !important;
        color: white !important;
        padding: 2px 8px !important;
    }
    
    .social-icon {
        transition: all 0.3s ease !important;
    }
    
    .social-icon:hover {
        transform: translateY(-6px) scale(1.1) !important;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2) !important;
    }
    
    .social-icon:hover > div {
        left: 100% !important;
    }
    
    /* Responsive design */
    @media (max-width: 992px) {
        .contact-grid {
            max-width: 90% !important;
            margin: 2rem auto !important;
        }
        
        .contact-info-card {
            padding: 2rem !important;
        }
        
        .info-title {
            font-size: 2.2rem !important;
        }
    }
    
    @media (max-width: 768px) {
        .contact-grid {
            padding: 0 1rem !important;
        }
        
        .contact-info-card {
            padding: 1.5rem !important;
        }
        
        .contact-info-item {
            grid-template-columns: 1fr !important;
            gap: 1.5rem !important;
            padding: 1.8rem !important;
        }
        
        .info-title {
            font-size: 1.8rem !important;
            margin-bottom: 2rem !important;
        }
        
        .contact-info-item h3 {
            font-size: 1.2rem !important;
        }
        
        .contact-info-item p {
            font-size: 1rem !important;
        }
    }
    
    @media (max-width: 576px) {
        .contact-grid {
            max-width: 100% !important;
            margin: 1.5rem auto !important;
            padding: 0 1rem !important;
        }
        
        .contact-info-card {
            padding: 1.2rem !important;
            border-radius: 16px !important;
        }
        
        .info-title {
            font-size: 1.6rem !important;
        }
        
        .contact-info-item {
            padding: 1.2rem !important;
            min-height: auto !important;
        }
        
        .info-icon {
            width: 50px !important;
            height: 50px !important;
            min-width: 50px !important;
        }
        
        .info-icon i {
            font-size: 1.4rem !important;
        }
        
        .social-icon {
            width: 48px !important;
            height: 48px !important;
            font-size: 1.4rem !important;
        }
    }
</style>

<script>
    // Th√™m hi·ªáu ·ª©ng hover cho c√°c item
    document.addEventListener('DOMContentLoaded', function() {
        const contactItems = document.querySelectorAll('.contact-info-item');
        const socialIcons = document.querySelectorAll('.social-icon');
        
        // Hi·ªáu ·ª©ng cho contact items
        contactItems.forEach(item => {
            item.addEventListener('mouseenter', function() {
                const icon = this.querySelector('.info-icon');
                icon.style.transform = 'rotate(15deg) scale(1.1)';
                this.style.transform = 'translateY(-8px)';
            });
            
            item.addEventListener('mouseleave', function() {
                const icon = this.querySelector('.info-icon');
                icon.style.transform = 'rotate(0deg) scale(1)';
                this.style.transform = 'translateY(0)';
            });
        });
        
        // Hi·ªáu ·ª©ng cho social icons
        socialIcons.forEach(icon => {
            icon.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-6px) scale(1.1)';
                const shine = this.querySelector('div');
                shine.style.left = '100%';
            });
            
            icon.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
                const shine = this.querySelector('div');
                shine.style.left = '-100%';
            });
        });
    });
</script>            
            <!-- Map Section -->
            <div class="map-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3928.841708394135!2d105.76941497507146!3d10.029933189993744!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31a0883e1a6c7a3b%3A0x3d1e5dfc9c0e3b0d!2sCan%20Tho%20University!5e0!3m2!1sen!2s!4v1648567890123!5m2!1sen!2s" 
                        allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Caf√© Focus</h3>
                    <p>M√¥ h√¨nh Caf√© Focus k·∫øt h·ª£p c√¥ng ngh·ªá, mang ƒë·∫øn kh√¥ng gian l√†m vi·ªác & h·ªçc t·∫≠p hi·ªáu qu·∫£ nh·∫•t</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-tiktok"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h3>Li√™n k·∫øt nhanh</h3>
                    <ul>
                        <li><a href="../index.html">TRANG CH·ª¶</a></li>
                        <li><a href="about.html">V·ªÄ CH√öNG T√îI</a></li>
                        <li><a href="services.html">KH√îNG GIAN & D·ªäCH V·ª§</a></li>
                        <li><a href="menu.html">MENU</a></li>
                        <li><a href="contact.html" class="active">ƒê·∫∂T B√ÄN</a></li>
                        <li><a href="reviews.html">ƒê√ÅNH GI√Å‚≠ê</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Li√™n h·ªá</h3>
                    <p><i class="fas fa-map-marker-alt"></i> 123A, ƒê∆∞·ªùng Nguy·ªÖn VƒÉn C·ª´ N·ªëi D√†i, Ph∆∞·ªùng Ninh Ki·ªÅu, C·∫ßn Th∆°</p>
                    <p><i class="fas fa-phone"></i> 0909 123 456</p>
                    <p><i class="fas fa-envelope"></i> info@cafefocus.com</p>
                </div>
                <div class="footer-col">
                    <h3>Gi·ªù m·ªü c·ª≠a</h3>
                    <p>Th·ª© 2 - Th·ª© 7: 7:00 - 00:00</p>
                    <p>Ch·ªß nh·∫≠t: 7:00 - 22:00</p>
                    <p>M·ªü c·ª≠a c·∫£ ng√†y l·ªÖ</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Caf√© Focus. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../js/script.js"></script>
<script>
    // Bi·∫øn l∆∞u th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i
    let currentUser = null;

    document.addEventListener('DOMContentLoaded', function() {
        // L·∫•y th√¥ng tin ng∆∞·ªùi d√πng t·ª´ localStorage ho·∫∑c session
        loadCurrentUser();
        
        // Set min date for booking (today)
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('booking-date').min = today;
        
        // Handle table type selection
        const tableOptions = document.querySelectorAll('.table-type-option');
        const tableTypeInput = document.getElementById('table-type');
        
        tableOptions.forEach(option => {
            option.addEventListener('click', function() {
                // Remove active class from all options
                tableOptions.forEach(opt => opt.classList.remove('active'));
                
                // Add active class to clicked option
                this.classList.add('active');
                
                // Set the value to hidden input
                        tableTypeInput.value = this.getAttribute('data-type');

                        // Update available tables dropdown based on selected type
                        if (typeof updateAvailableTables === 'function') {
                            updateAvailableTables(tableTypeInput.value);
                        }
            });
        });
        
        // Booking form submission
        const bookingForm = document.getElementById('bookingForm');
        const bookingSuccess = document.getElementById('bookingSuccess');
        
        if (bookingForm) {
            bookingForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Ki·ªÉm tra ƒëƒÉng nh·∫≠p
                if (!currentUser) {
                    alert('VUI L√íNG ƒêƒÇNG NH·∫¨P ƒê·ªÇ ƒê·∫∂T B√ÄN!');
                    // Redirect to login or show login modal
                    return;
                }
                
                // Validate required fields
                const requiredFields = [
                    'booking-date',
                    'booking-time',
                    'duration',
                    'number-of-people',
                    'table-type',
                    'table-number',
                    'customer-name',
                    'customer-phone',
                    'customer-email'
                ];
                
                let isValid = true;
                let firstInvalidField = null;
                
                requiredFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field.value.trim()) {
                        isValid = false;
                        if (!firstInvalidField) firstInvalidField = field;
                        field.style.borderColor = '#e74c3c';
                    } else {
                        field.style.borderColor = '#ddd';
                    }
                });
                
                if (!isValid) {
                    alert('VUI L√íNG ƒêI·ªÄN ƒê·∫¶Y ƒê·ª¶ TH√îNG TIN B·∫ÆT BU·ªòC!');
                    if (firstInvalidField) firstInvalidField.focus();
                    return;
                }
                
                // Phone validation
                const phoneRegex = /^(0|\+84)(3[2-9]|5[6|8|9]|7[0|6-9]|8[1-9]|9[0-9])[0-9]{7}$/;
                const phoneValue = document.getElementById('customer-phone').value.replace(/ /g, '');
                
                if (!phoneRegex.test(phoneValue)) {
                    alert('S·ªê ƒêI·ªÜN THO·∫†I KH√îNG H·ª¢P L·ªÜ!');
                    document.getElementById('customer-phone').focus();
                    document.getElementById('customer-phone').style.borderColor = '#e74c3c';
                    return;
                }
                
                // Email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                const emailValue = document.getElementById('customer-email').value;
                
                if (!emailRegex.test(emailValue)) {
                    alert('EMAIL KH√îNG H·ª¢P L·ªÜ!');
                    document.getElementById('customer-email').focus();
                    document.getElementById('customer-email').style.borderColor = '#e74c3c';
                    return;
                }
                
                // Show loading
                const submitBtn = bookingForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ƒêANG X·ª¨ L√ù...';
                submitBtn.disabled = true;
                
                // Collect form data
                const formData = {
                    date: document.getElementById('booking-date').value,
                    time: document.getElementById('booking-time').value,
                    duration: document.getElementById('duration').value,
                    people: document.getElementById('number-of-people').value,
                    tableType: document.getElementById('table-type').value,
                    tableNumber: document.getElementById('table-number').value,
                    name: document.getElementById('customer-name').value,
                    phone: document.getElementById('customer-phone').value,
                    email: document.getElementById('customer-email').value,
                    notes: document.getElementById('additional-notes').value,
                    userId: currentUser.id,
                    userEmail: currentUser.email
                };

                // Check selected table availability (if helper exists)
                const selectedTable = formData.tableNumber;
                if (selectedTable) {
                    if (typeof getUnavailableTables === 'function') {
                        const unavailable = getUnavailableTables(formData.date, formData.time, formData.duration);
                        if (unavailable.includes(Number(selectedTable))) {
                            alert('B√ÄN ƒê√É ƒê∆Ø·ª¢C CH·ªåN. VUI L√íNG CH·ªåN B√ÄN KH√ÅC.');
                            // Restore submit button
                            const submitBtn = bookingForm.querySelector('button[type="submit"]');
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                            return;
                        }
                    }
                }
                
                // Simulate API call
                setTimeout(() => {
                    // Save to localStorage
                    const bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
                    const bookingRecord = {
                        id: Date.now(),
                        ...formData,
                        displayDate: document.getElementById('booking-date-display').value,
                        submittedAt: new Date().toLocaleString('vi-VN'),
                        status: 'pending', // M·∫∑c ƒë·ªãnh l√† ch·ªù x√°c nh·∫≠n
                        userRole: currentUser.role // L∆∞u role c·ªßa ng∆∞·ªùi ƒë·∫∑t
                    };
                    bookingHistory.unshift(bookingRecord);
                    localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
                    
                    // Hide form and show success message
                    bookingForm.style.display = 'none';
                    bookingSuccess.style.display = 'block';
                    
                    // Update history count
                    updateHistoryCount();
                    
                    // Log booking data
                    console.log('Booking Data Submitted:', formData);
                    
                    // Show notification
                    if (window.showNotification) {
                        showNotification('success', '‚úÖ ƒê·∫∂T B√ÄN TH√ÄNH C√îNG! CH√öNG T√îI S·∫º LI√äN H·ªÜ X√ÅC NH·∫¨N.');
                    }
                    
                    // Send confirmation email (simulated)
                    console.log('Confirmation email would be sent to:', formData.email);
                }, 1500);
            });
        }
        
        // Contact Form Handling
        const contactForm = document.getElementById('contactForm');
        const contactSuccessMessage = document.getElementById('successMessage');
        
        if (contactForm) {
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Get form data
                const formData = {
                    name: document.getElementById('fullName').value,
                    phone: document.getElementById('phone').value,
                    email: document.getElementById('email').value,
                    subject: document.getElementById('subject').value,
                    message: document.getElementById('message').value
                };
                
                // Validation
                if (!formData.name || !formData.phone || !formData.email || !formData.subject || !formData.message) {
                    alert('VUI L√íNG ƒêI·ªÄN ƒê·∫¶Y ƒê·ª¶ TH√îNG TIN!');
                    return;
                }
                
                // Phone validation
                const phoneRegex = /^(0|\+84)(3[2-9]|5[6|8|9]|7[0|6-9]|8[1-9]|9[0-9])[0-9]{7}$/;
                if (!phoneRegex.test(formData.phone.replace(/ /g, ''))) {
                    alert('S·ªê ƒêI·ªÜN THO·∫†I KH√îNG H·ª¢P L·ªÜ!');
                    return;
                }
                
                // Email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(formData.email)) {
                    alert('EMAIL KH√îNG H·ª¢P L·ªÜ!');
                    return;
                }
                
                // Show loading
                const submitBtn = contactForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ƒêANG G·ª¨I...';
                submitBtn.disabled = true;
                
                // Simulate API call
                setTimeout(() => {
                    // Hide form and show success message
                    contactForm.style.display = 'none';
                    contactSuccessMessage.style.display = 'block';
                    
                    // Reset button
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    
                    // Log form data
                    console.log('Contact Form Submitted:', formData);
                    
                    // Show notification
                    if (window.showNotification) {
                        showNotification('success', '‚úÖ G·ª¨I LI√äN H·ªÜ TH√ÄNH C√îNG! CH√öNG T√îI S·∫º PH·∫¢N H·ªíI S·ªöM.');
                    }
                }, 1500);
            });
        }
        
        // Add active class to current page in nav
        const currentPage = window.location.pathname.split('/').pop();
        const navLinks = document.querySelectorAll('.nav-menu a');
        navLinks.forEach(link => {
            if (link.getAttribute('href') === currentPage) {
                link.classList.add('active');
            }
        });
    });
    
    // H√†m l·∫•y th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i
    function loadCurrentUser() {
        // Ki·ªÉm tra sessionStorage ho·∫∑c localStorage
        const userData = localStorage.getItem('cafeUser');
        if (userData) {
            currentUser = JSON.parse(userData);
            
            // C·∫≠p nh·∫≠t UI v·ªõi th√¥ng tin ng∆∞·ªùi d√πng
            if (document.getElementById('userName')) {
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('dropdownUserName').textContent = currentUser.name;
                document.getElementById('userEmail').textContent = currentUser.email;
                document.getElementById('userAvatar').textContent = currentUser.avatar || currentUser.name.substring(0, 2);
            }
        } else {
            // N·∫øu kh√¥ng c√≥ ng∆∞·ªùi d√πng, s·ª≠ d·ª•ng m·∫∑c ƒë·ªãnh
            currentUser = {
                id: null,
                name: 'Kh√°ch',
                email: '',
                role: 'guest',
                avatar: 'KH'
            };
        }
        
        // Ki·ªÉm tra n·∫øu l√† admin th√¨ th√™m badge
        if (currentUser.role === 'admin' && document.getElementById('userName')) {
            document.getElementById('userName').innerHTML = `${currentUser.name}`;
        }
    }
    
    function resetBookingForm() {
        const bookingForm = document.getElementById('bookingForm');
        const bookingSuccess = document.getElementById('bookingSuccess');
        
        // Reset form
        bookingForm.reset();
        
        // Reset table type selection
        document.querySelectorAll('.table-type-option').forEach(opt => {
            opt.classList.remove('active');
        });
        document.getElementById('table-type').value = '';
        
        // Show form and hide success message
        bookingForm.style.display = 'block';
        bookingSuccess.style.display = 'none';
        
        // Reset button state
        const submitBtn = bookingForm.querySelector('button[type="submit"]');
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fas fa-check-circle"></i> ƒê·∫∂T B√ÄN NGAY';
        
        // Re-initialize date
        initBookingPage();
        
        // Set focus to first field
        document.getElementById('booking-date').focus();
    }
    
    function resetContactForm() {
        const contactForm = document.getElementById('contactForm');
        const successMessage = document.getElementById('successMessage');
        
        // Reset form
        contactForm.reset();
        
        // Show form and hide success message
        contactForm.style.display = 'block';
        successMessage.style.display = 'none';
    }
    
    // Switch tab function
    function switchTab(tabName) {
        const bookingForm = document.getElementById('bookingForm');
        const bookingSuccess = document.getElementById('bookingSuccess');
        const bookingHistoryTab = document.getElementById('booking-history-tab');
        const tabButtons = document.querySelectorAll('.booking-tab-btn');
        
        // Ki·ªÉm tra ƒëƒÉng nh·∫≠p cho l·ªãch s·ª≠ ƒë·∫∑t b√†n
        if (tabName === 'booking-history' && !currentUser.id) {
            alert('VUI L√íNG ƒêƒÇNG NH·∫¨P ƒê·ªÇ XEM L·ªäCH S·ª¨ ƒê·∫∂T B√ÄN!');
            return;
        }
        
        // Hide all tabs
        bookingForm.style.display = 'none';
        bookingSuccess.style.display = 'none';
        bookingHistoryTab.style.display = 'none';
        
        // Remove active class from all buttons
        tabButtons.forEach(btn => {
            btn.style.color = '#999';
            btn.style.borderBottomColor = 'transparent';
        });
        
        // Show selected tab and update button
        if (tabName === 'booking-form') {
            bookingForm.style.display = 'block';
            tabButtons[0].style.color = '#2a6bff';
            tabButtons[0].style.borderBottomColor = '#2a6bff';
        } else if (tabName === 'booking-history') {
            bookingHistoryTab.style.display = 'block';
            tabButtons[1].style.color = '#2a6bff';
            tabButtons[1].style.borderBottomColor = '#2a6bff';
            loadBookingHistory();
        }
    }
    
    // Load and display booking history
    function loadBookingHistory() {
        const bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        const historyList = document.getElementById('booking-history-list');
        
        // L·ªçc l·ªãch s·ª≠ d·ª±a tr√™n vai tr√≤
        let filteredHistory = [];
        
        if (currentUser.role === 'admin') {
            // Admin xem t·∫•t c·∫£
            filteredHistory = bookingHistory;
        } else {
            // User ch·ªâ xem c·ªßa m√¨nh
            filteredHistory = bookingHistory.filter(booking => 
                booking.userId === currentUser.id
            );
        }

        // Apply UI filters (status, time, table, datetime ¬± hours, search)
        const statusFilterEl = document.getElementById('booking-filter-status');
        const timeFilterEl = document.getElementById('booking-filter-time');
        const tableFilterEl = document.getElementById('booking-filter-table');
        const refDateTimeEl = document.getElementById('booking-filter-datetime');
        const hoursEl = document.getElementById('booking-filter-hours');
        const searchFilterEl = document.getElementById('booking-filter-search');

        const statusFilter = statusFilterEl ? statusFilterEl.value : 'all';
        const timeFilter = timeFilterEl ? timeFilterEl.value : '';
        const tableFilter = tableFilterEl ? tableFilterEl.value : '';
        const refDateTime = refDateTimeEl ? refDateTimeEl.value : '';
        const hoursRange = hoursEl ? Number(hoursEl.value) : 0;
        const q = searchFilterEl ? searchFilterEl.value.trim().toLowerCase() : '';

        if (statusFilter && statusFilter !== 'all') {
            filteredHistory = filteredHistory.filter(b => (b.status || 'pending') === statusFilter);
        }

        if (timeFilter) {
            // Treat selected time-of-day as a time that must fall inside the booking interval
            filteredHistory = filteredHistory.filter(b => {
                if (!b.date || !b.time) return false;
                const bookingStart = new Date(b.date + 'T' + (b.time.length === 5 ? b.time : b.time + ':00'));
                const durationHours = Number(b.duration) || 0;
                const bookingEnd = new Date(bookingStart.getTime() + durationHours * 36e5);
                const timeDt = new Date(b.date + 'T' + (timeFilter.length === 5 ? timeFilter : timeFilter + ':00'));
                return timeDt >= bookingStart && timeDt <= bookingEnd;
            });
        }

        if (refDateTime) {
            // Reference datetime must fall within booking start..(start+duration)
            const ref = new Date(refDateTime);
            filteredHistory = filteredHistory.filter(b => {
                if (!b.date || !b.time) return false;
                const bookingStart = new Date(b.date + 'T' + (b.time.length === 5 ? b.time : b.time + ':00'));
                const durationHours = Number(b.duration) || 0;
                const bookingEnd = new Date(bookingStart.getTime() + durationHours * 36e5);
                return ref >= bookingStart && ref <= bookingEnd;
            });
        } else if (hoursRange && hoursRange > 0) {
            // Backwards-compatible: if user specified only hours-range, match bookings whose start is within ¬±hoursRange of now
            const now = new Date();
            filteredHistory = filteredHistory.filter(b => {
                if (!b.date || !b.time) return false;
                const bookingDt = new Date(b.date + 'T' + (b.time.length === 5 ? b.time : b.time + ':00'));
                const diffHours = Math.abs((bookingDt - now) / 36e5);
                return diffHours <= hoursRange;
            });
        }

        if (tableFilter) {
            filteredHistory = filteredHistory.filter(b => String(b.tableNumber || '') === String(tableFilter));
        }

        if (q) {
            filteredHistory = filteredHistory.filter(b => {
                const name = (b.name || '').toLowerCase();
                const phone = (b.phone || '').toLowerCase();
                const email = (b.email || '').toLowerCase();
                return name.includes(q) || phone.includes(q) || email.includes(q);
            });
        }
        
        if (filteredHistory.length === 0) {
            const noBookingMsg = currentUser.role === 'admin' 
                ? 'Ch∆∞a c√≥ ƒë∆°n ƒë·∫∑t b√†n n√†o trong h·ªá th·ªëng'
                : 'B·∫°n ch∆∞a c√≥ ƒë∆°n ƒë·∫∑t b√†n n√†o';
                
            historyList.innerHTML = `<p style="text-align: center; color: #999; padding: 30px;">${noBookingMsg}</p>`;
            return;
        }
        
        let html = '';
        const tableTypeLabels = {
            'window': 'B√†n c·ª≠a s·ªï',
            'quiet': 'Khu y√™n tƒ©nh',
            'group': 'B√†n nh√≥m',
            'single': 'B√†n ƒë∆°n',
            'vip': 'Ph√≤ng VIP',
            'outdoor': 'Khu ngo√†i tr·ªùi'
        };
        
        filteredHistory.forEach((booking, index) => {
            const status = booking.status || 'pending';
            let statusBadge = '';
            if (status === 'confirmed') {
                statusBadge = '<span style="background: #2ecc71; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">‚úì ƒê√É X√ÅC NH·∫¨N</span>';
            } else if (status === 'checked-in') {
                statusBadge = '<span style="background: #00a86b; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">üü¢ ƒêANG S·ª¨ D·ª§NG</span>';
            } else if (status === 'completed') {
                statusBadge = '<span style="background: #3498db; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">‚úÖ HO√ÄN T·∫§T</span>';
            } else if (status === 'no-show') {
                statusBadge = '<span style="background: #e74c3c; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">üö´ KH√îNG ƒê·∫æN</span>';
            } else if (status === 'unavailable') {
                statusBadge = '<span style="background: #e74c3c; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">‚úó H·∫æT B√ÄN</span>';
            } else {
                statusBadge = '<span style="background: #f39c12; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">‚è± CH·ªú X√ÅC NH·∫¨N</span>';
            }
            
            // Hi·ªÉn th·ªã th√¥ng tin ng∆∞·ªùi ƒë·∫∑t n·∫øu l√† admin
            const userInfo = currentUser.role === 'admin' ? 
                `<div style="margin-bottom: 5px;">
                    <small style="color: #666; font-weight: 600;">Ng∆∞·ªùi ƒë·∫∑t: ${booking.name}</small>
                    ${booking.userEmail ? `<br><small style="color: #666;">Email: ${booking.userEmail}</small>` : ''}
                </div>` : '';
            
            // N√∫t ƒëi·ªÅu khi·ªÉn d·ª±a tr√™n vai tr√≤
            let actionButtons = '';
            
            if (currentUser.role === 'admin') {
                // Admin uses a dropdown to manage status + delete
                actionButtons = `
                    <div style="display: flex; gap: 10px; align-items: flex-end; margin-top: 15px;">
                        <div style="flex:1;">
                            <label style="display:block; font-size:0.85rem; color:#666; font-weight:600; margin-bottom:6px;">Tr·∫°ng th√°i</label>
                            <select onchange="updateBookingStatus(${booking.id}, this.value)" style="width:100%; padding:8px 10px; border-radius:8px; border:1px solid #ddd; font-weight:600;">
                                <option value="pending" ${status === 'pending' ? 'selected' : ''}>‚è± Ch·ªù x√°c nh·∫≠n</option>
                                <option value="confirmed" ${status === 'confirmed' ? 'selected' : ''}>‚úì ƒê√£ x√°c nh·∫≠n</option>
                                <option value="checked-in" ${status === 'checked-in' ? 'selected' : ''}>üü¢ Checked-in / ƒêang s·ª≠ d·ª•ng</option>
                                <option value="completed" ${status === 'completed' ? 'selected' : ''}>‚úÖ Ho√†n t·∫•t</option>
                                <option value="no-show" ${status === 'no-show' ? 'selected' : ''}>üö´ Kh√¥ng ƒë·∫øn</option>
                                <option value="unavailable" ${status === 'unavailable' ? 'selected' : ''}>‚úó H·∫øt b√†n</option>
                            </select>
                        </div>
                        <div style="width:120px;">
                            <button onclick="deleteBooking(${booking.id})" style="width:100%; padding:10px; background:#ff6b6b; color:white; border:none; border-radius:8px; cursor:pointer; font-weight:600;"> <i class="fas fa-trash"></i> X√≥a</button>
                        </div>
                    </div>
                `;
            } else {
                // User ch·ªâ c√≥ th·ªÉ x√≥a khi ch∆∞a c√≥ tr·∫°ng th√°i (ch·ªù x√°c nh·∫≠n)
                actionButtons = `
                    <div style="display: flex; justify-content: flex-end; margin-top: 15px;">
                        <button onclick="deleteBooking(${booking.id})" ${status !== 'pending' ? 'disabled' : ''} style="padding: 10px; background: ${status !== 'pending' ? '#95a5a6' : '#ff6b6b'}; color: white; border: none; border-radius: 8px; cursor: ${status !== 'pending' ? 'not-allowed' : 'pointer'}; font-weight: 600; transition: all 0.3s ease;">
                            <i class="fas fa-trash"></i> ${status !== 'pending' ? 'Kh√¥ng th·ªÉ h·ªßy' : 'H·ªßy ƒë·∫∑t b√†n'}
                        </button>
                    </div>
                `;
            }
            
            html += `
                <div style="padding: 20px; border: 1px solid #e0e0e0; border-radius: 12px; background: #fafafa; transition: all 0.3s ease;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <h4 style="color: #2c3e50; margin: 0; font-size: 1.1rem;">#${filteredHistory.length - index}</h4>
                            ${statusBadge}
                        </div>
                        <span style="color: #2a6bff; font-weight: 600; font-size: 0.9rem;">${booking.submittedAt}</span>
                    </div>
                    
                    ${userInfo}
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 15px;">
                        <div>
                            <p style="color: #999; margin: 0 0 5px 0; font-size: 0.85rem; font-weight: 600;">Ng√†y - Gi·ªù</p>
                            <p style="color: #2c3e50; margin: 0; font-weight: 600;">${booking.displayDate} l√∫c ${booking.time}</p>
                        </div>
                        <div>
                            <p style="color: #999; margin: 0 0 5px 0; font-size: 0.85rem; font-weight: 600;">Th·ªùi l∆∞·ª£ng</p>
                            <p style="color: #2c3e50; margin: 0; font-weight: 600;">${booking.duration} gi·ªù</p>
                        </div>
                        <div>
                            <p style="color: #999; margin: 0 0 5px 0; font-size: 0.85rem; font-weight: 600;">S·ªë ng∆∞·ªùi</p>
                            <p style="color: #2c3e50; margin: 0; font-weight: 600;">${booking.people} ng∆∞·ªùi</p>
                        </div>
                        <div>
                            <p style="color: #999; margin: 0 0 5px 0; font-size: 0.85rem; font-weight: 600;">Lo·∫°i b√†n</p>
                            <p style="color: #2c3e50; margin: 0; font-weight: 600;">${tableTypeLabels[booking.tableType] || booking.tableType}</p>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 10px; display: flex; gap: 10px; align-items: center;">
                        <div>
                            <p style="color: #999; margin: 0 0 3px 0; font-size: 0.85rem; font-weight: 600;">B√†n</p>
                            <p style="color: #2c3e50; margin: 0; font-weight: 600;">${booking.tableNumber ? ('B√†n ' + booking.tableNumber) : '<em>Ch∆∞a ch·ªçn</em>'}</p>
                        </div>
                        ${currentUser.role === 'admin' ? (`<div style="margin-left: auto;">
                            <label style="display:block; font-size:0.85rem; color:#666; font-weight:600; margin-bottom:6px;">G√°n/Ch·ªçn l·∫°i b√†n</label>
                            <select id="table-select-${booking.id}" onchange="updateBookingTable(${booking.id}, this.value)" style="padding:8px 10px; border-radius:8px; border:1px solid #ddd;"></select>
                        </div>`) : ''}
                    </div>

                    <div style="border-top: 1px solid #e0e0e0; padding-top: 15px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                            <div>
                                <p style="color: #999; margin: 0 0 3px 0; font-size: 0.85rem; font-weight: 600;">T√™n kh√°ch</p>
                                <p style="color: #2c3e50; margin: 0;">${booking.name}</p>
                            </div>
                            <div>
                                <p style="color: #999; margin: 0 0 3px 0; font-size: 0.85rem; font-weight: 600;">ƒêi·ªán tho·∫°i</p>
                                <p style="color: #2c3e50; margin: 0;">${booking.phone}</p>
                            </div>
                        </div>
                        <div>
                            <p style="color: #999; margin: 0 0 3px 0; font-size: 0.85rem; font-weight: 600;">Email</p>
                            <p style="color: #2c3e50; margin: 0;">${booking.email}</p>
                        </div>
                        ${booking.specialRequests ? `<div style="margin-top: 10px;">
                            <p style="color: #999; margin: 0 0 3px 0; font-size: 0.85rem; font-weight: 600;">Y√™u c·∫ßu ƒë·∫∑c bi·ªát</p>
                            <p style="color: #2c3e50; margin: 0;">${booking.specialRequests}</p>
                        </div>` : ''}
                    </div>
                    
                    ${actionButtons}
                </div>
            `;
        });
        
        historyList.innerHTML = html;

        // Initialize table select dropdowns after rendering
        if (typeof initializeTableDropdowns === 'function') {
            initializeTableDropdowns();
        }

        // Attach filter control handlers (idempotent assignment)
        const statusEl = document.getElementById('booking-filter-status');
        const timeEl = document.getElementById('booking-filter-time');
        const tableEl = document.getElementById('booking-filter-table');
        const searchEl = document.getElementById('booking-filter-search');
        const clearBtn = document.getElementById('booking-filter-clear');
        if (statusEl) statusEl.onchange = loadBookingHistory;
        if (timeEl) timeEl.onchange = loadBookingHistory;
        if (tableEl) tableEl.onchange = loadBookingHistory;
        if (searchEl) searchEl.oninput = debounce(loadBookingHistory, 300);
        if (clearBtn) clearBtn.onclick = function() { if(statusEl) statusEl.value = 'all'; if(timeEl) timeEl.value = ''; if(tableEl) tableEl.value = ''; if(searchEl) searchEl.value = ''; loadBookingHistory(); };
    }
    
    // Delete booking from history
    function deleteBooking(bookingId) {
        let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        const booking = bookingHistory.find(b => b.id === bookingId);
        
        if (!booking) {
            alert('Kh√¥ng t√¨m th·∫•y ƒë∆°n ƒë·∫∑t b√†n!');
            return;
        }
        
        // Ki·ªÉm tra quy·ªÅn x√≥a
        if (currentUser.role === 'admin') {
            // Admin c√≥ th·ªÉ x√≥a b·∫•t k·ª≥ ƒë∆°n n√†o
            if (confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a ƒë∆°n ƒë·∫∑t b√†n n√†y?')) {
                bookingHistory = bookingHistory.filter(b => b.id !== bookingId);
                localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
                updateHistoryCount();
                loadBookingHistory();
                alert('‚úì ƒê√£ x√≥a ƒë∆°n ƒë·∫∑t b√†n!');
            }
        } else {
            // User ch·ªâ c√≥ th·ªÉ x√≥a ƒë∆°n c·ªßa m√¨nh v√† khi ch∆∞a c√≥ tr·∫°ng th√°i
            if (booking.userId !== currentUser.id) {
                alert('B·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a ƒë∆°n ƒë·∫∑t b√†n n√†y!');
                return;
            }
            
            if (booking.status !== 'pending') {
                alert('Kh√¥ng th·ªÉ h·ªßy ƒë∆°n ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n ho·∫∑c ƒë√°nh d·∫•u h·∫øt b√†n!');
                return;
            }
            
            if (confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë∆°n ƒë·∫∑t b√†n n√†y?')) {
                bookingHistory = bookingHistory.filter(b => b.id !== bookingId);
                localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
                updateHistoryCount();
                loadBookingHistory();
                alert('‚úì ƒê√£ h·ªßy ƒë∆°n ƒë·∫∑t b√†n!');
            }
        }
    }
    
    // Confirm booking - Ch·ªâ admin m·ªõi c√≥ quy·ªÅn
    function confirmBooking(bookingId) {
        if (currentUser.role !== 'admin') {
            alert('Ch·ªâ qu·∫£n tr·ªã vi√™n m·ªõi c√≥ quy·ªÅn x√°c nh·∫≠n ƒë·∫∑t b√†n!');
            return;
        }
        
        let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        const booking = bookingHistory.find(b => b.id === bookingId);
        if (booking) {
            booking.status = 'confirmed';
            localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
            loadBookingHistory();
            alert('‚úì ƒê√£ x√°c nh·∫≠n ƒë·∫∑t b√†n th√†nh c√¥ng!');
        }
    }

    // --- Table availability and management helpers ---
    function getAllTables() {
        const tables = [];
        for (let i = 1; i <= 20; i++) {
            let type = 'single';
            if (i <= 6) type = 'single';
            else if (i <= 14) type = 'group';
            else if (i <= 18) type = 'vip';
            else type = 'outdoor';
            tables.push({ number: i, type });
        }
        return tables;
    }

    // Return unavailable tables optionally filtered by date/time overlap.
    // If `date` is provided, only bookings on that date are considered.
    // If `time` and `duration` are provided, only bookings that overlap the
    // given time interval are considered unavailable. If no `date` is passed,
    // the function falls back to global behavior (all confirmed/checked-in tables).
    function getUnavailableTables(date, time, duration) {
        const bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        const unavailable = [];

        bookingHistory.forEach(b => {
            if (!b.tableNumber) return;
            if (!(b.status === 'confirmed' || b.status === 'checked-in')) return;

            // If no filter date provided, keep original behavior (global unavailable)
            if (!date) {
                unavailable.push(Number(b.tableNumber));
                return;
            }

            // Only consider bookings on the same date
            if (b.date !== date) return;

            // If no time filter provided, mark table unavailable for that date
            if (!time) {
                unavailable.push(Number(b.tableNumber));
                return;
            }

            // Check time overlap between booking b and provided time+duration
            function toDateTime(d, t) {
                const tfull = (t || '').length === 5 ? t + ':00' : (t || '00:00:00');
                return new Date(d + 'T' + tfull);
            }

            const bStart = toDateTime(b.date, b.time || '00:00');
            const bDuration = Number(b.duration) || 0;
            const bEnd = new Date(bStart.getTime() + bDuration * 36e5);

            const selStart = toDateTime(date, time);
            const selDuration = Number(duration) || 0;
            const selEnd = new Date(selStart.getTime() + selDuration * 36e5);

            // Overlap if selStart < bEnd && selEnd > bStart
            if (selStart < bEnd && selEnd > bStart) {
                unavailable.push(Number(b.tableNumber));
            }
        });

        return Array.from(new Set(unavailable));
    }

    function updateAvailableTables(tableType) {
        const select = document.getElementById('table-number');
        if (!select) return;
        const all = getAllTables().filter(t => !tableType || t.type === tableType);
        const date = (document.getElementById('booking-date') && document.getElementById('booking-date').value) || '';
        const time = (document.getElementById('booking-time') && document.getElementById('booking-time').value) || '';
        const duration = (document.getElementById('duration') && document.getElementById('duration').value) || '';
        const unavailable = getUnavailableTables(date, time, duration);
        select.innerHTML = '<option value="">Ch·ªçn b√†n (t·ª± ƒë·ªông hi·ªÉn th·ªã theo lo·∫°i)</option>';
        all.forEach(t => {
            const opt = document.createElement('option');
            opt.value = t.number;
            opt.textContent = 'B√†n ' + t.number + (unavailable.includes(t.number) ? ' (ƒê√£ ch·ªçn)' : '');
            if (unavailable.includes(t.number)) opt.disabled = true;
            select.appendChild(opt);
        });
    }

    function populateTableSelectForBooking(selectEl, booking) {
        if (!selectEl) return;
        selectEl.innerHTML = '';
        const all = getAllTables();
        // Allow showing tables of same type first
        const preferred = all.filter(t => t.type === booking.tableType);
        const others = all.filter(t => t.type !== booking.tableType);
        const ordered = preferred.concat(others);
        const unavailable = getUnavailableTables(booking.date, booking.time, booking.duration).filter(n => !(booking.tableNumber && Number(booking.tableNumber) === n));
        selectEl.appendChild(new Option('Ch∆∞a ch·ªçn', ''));
        ordered.forEach(t => {
            const opt = new Option('B√†n ' + t.number, t.number);
            if (unavailable.includes(t.number)) opt.disabled = true;
            selectEl.appendChild(opt);
        });
        if (booking.tableNumber) selectEl.value = booking.tableNumber;
    }

    function initializeTableDropdowns() {
        const bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        bookingHistory.forEach(b => {
            const sel = document.getElementById('table-select-' + b.id);
            if (sel) populateTableSelectForBooking(sel, b);
        });
    }

    // Populate the booking history table-filter dropdown (list of table numbers)
    function populateBookingTableFilter() {
        const sel = document.getElementById('booking-filter-table');
        if (!sel) return;
        sel.innerHTML = '<option value="">T·∫•t c·∫£ b√†n</option>';
        const all = getAllTables();
        all.forEach(t => {
            const opt = document.createElement('option');
            opt.value = t.number;
            opt.textContent = 'B√†n ' + t.number;
            sel.appendChild(opt);
        });
    }

    function updateBookingTable(bookingId, tableNumber) {
        if (currentUser.role !== 'admin') {
            alert('Ch·ªâ qu·∫£n tr·ªã vi√™n m·ªõi c√≥ quy·ªÅn thay ƒë·ªïi b√†n!');
            return;
        }

        let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        const booking = bookingHistory.find(b => b.id === bookingId);
        if (!booking) {
            alert('ƒê∆°n ƒë·∫∑t b√†n kh√¥ng t·ªìn t·∫°i!');
            return;
        }

        const num = tableNumber ? Number(tableNumber) : null;
        const unavailable = getUnavailableTables(booking.date, booking.time, booking.duration).filter(n => !(booking.tableNumber && Number(booking.tableNumber) === n));
        if (num && unavailable.includes(num)) {
            alert('B√†n ƒë√£ kh√¥ng kh·∫£ d·ª•ng. Vui l√≤ng ch·ªçn b√†n kh√°c.');
            initializeTableDropdowns();
            return;
        }

        booking.tableNumber = num;
        localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
        loadBookingHistory();
        alert('‚úì ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin b√†n cho ƒë∆°n ƒë·∫∑t!');
    }
    
    function updateBookingStatus(bookingId, newStatus) {
        if (currentUser.role !== 'admin') {
            alert('Ch·ªâ qu·∫£n tr·ªã vi√™n m·ªõi c√≥ quy·ªÅn thay ƒë·ªïi tr·∫°ng th√°i!');
            return;
        }

        let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        const booking = bookingHistory.find(b => b.id === bookingId);
        if (!booking) {
            alert('ƒê∆°n ƒë·∫∑t b√†n kh√¥ng t·ªìn t·∫°i!');
            return;
        }

        // If confirming or checking-in and no table assigned, try to auto-assign an available table of the same type
        if ((newStatus === 'confirmed' || newStatus === 'checked-in') && !booking.tableNumber) {
            const all = getAllTables().filter(t => t.type === booking.tableType);
            const unavailable = getUnavailableTables(booking.date, booking.time, booking.duration);
            const available = all.map(t => t.number).filter(n => !unavailable.includes(n));
            if (available.length > 0) {
                booking.tableNumber = available[0];
            } else {
                alert('Kh√¥ng c√≥ b√†n tr·ªëng cho lo·∫°i n√†y. Vui l√≤ng g√°n b√†n tr∆∞·ªõc khi x√°c nh·∫≠n.');
                loadBookingHistory();
                initializeTableDropdowns();
                return;
            }
        }

        booking.status = newStatus;
        localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
        loadBookingHistory();
        alert('‚úì Tr·∫°ng th√°i ƒë∆°n ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t!');
    }
    
    // Mark booking as unavailable - Ch·ªâ admin m·ªõi c√≥ quy·ªÅn
    function markUnavailable(bookingId) {
        if (currentUser.role !== 'admin') {
            alert('Ch·ªâ qu·∫£n tr·ªã vi√™n m·ªõi c√≥ quy·ªÅn ƒë√°nh d·∫•u h·∫øt b√†n!');
            return;
        }
        
        if (confirm('X√°c nh·∫≠n ƒë√°nh d·∫•u l√† H·∫æT B√ÄN?')) {
            let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
            const booking = bookingHistory.find(b => b.id === bookingId);
            if (booking) {
                booking.status = 'unavailable';
                localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
                loadBookingHistory();
                alert('‚úó ƒê√£ ƒë√°nh d·∫•u h·∫øt b√†n!');
            }
        }
    }
    
    // Update history count badge - ch·ªâ ƒë·∫øm ƒë∆°n c·ªßa user n·∫øu kh√¥ng ph·∫£i admin
    function updateHistoryCount() {
        const bookingHistory = JSON.parse(localStorage.getItem('bookingHistory') || '[]');
        let count = 0;
        
        if (currentUser.role === 'admin') {
            count = bookingHistory.length;
        } else if (currentUser.id) {
            count = bookingHistory.filter(booking => booking.userId === currentUser.id).length;
        }
        
        document.getElementById('history-count').textContent = count;
    }
    
    // Initialize date picker
    function initBookingPage() {
        const today = new Date();
        
        // Format date as DD/MM/YYYY for Vietnamese display
        function formatDateVN(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }
        
        // Set default date to today (current date)
        const dateInput = document.getElementById('booking-date');
        const dateDisplay = document.getElementById('booking-date-display');
        
        if (dateInput && dateDisplay) {
            const todayStr = today.toISOString().split('T')[0];
            dateInput.value = todayStr;
            dateInput.min = todayStr; // Prevent selecting past dates
            dateDisplay.value = formatDateVN(today); // Show as DD/MM/YYYY
            
            // Handle date picker click
            dateDisplay.addEventListener('click', function() {
                dateInput.showPicker ? dateInput.showPicker() : dateInput.click();
            });
            
            // Update display when date changes
            dateInput.addEventListener('change', function() {
                if (this.value) {
                    const selectedDate = new Date(this.value + 'T00:00:00');
                    dateDisplay.value = formatDateVN(selectedDate);
                }
            });
        }
        
        // Set default time to current time
        const timeInput = document.getElementById('booking-time');
        if (timeInput) {
            const currentHour = today.getHours().toString().padStart(2, '0');
            const currentMinute = today.getMinutes().toString().padStart(2, '0');
            timeInput.value = `${currentHour}:${currentMinute}`;
        }
        
        // Update history count on load
        // Populate table dropdown based on default or selected table type
        if (typeof updateAvailableTables === 'function') {
            updateAvailableTables(document.getElementById('table-type').value || '');
        }
        // Populate table filter used in booking history
        if (typeof populateBookingTableFilter === 'function') populateBookingTableFilter();
        updateHistoryCount();
    }
    
    window.addEventListener('load', initBookingPage);
</script>
</body>
</html>